(this.webpackJsonpreenbit=this.webpackJsonpreenbit||[]).push([[0],{21:function(e,t,c){},24:function(e,t,c){"use strict";c.r(t);var a=c(2),n=c.n(a),s=c(11),r=c.n(s),i=(c(21),c(16)),o=c(4),l=c(7),j=c.n(l),u=c(10),h=c(3),b=c(12),d=c(5),_=c(1);var m=function(e){var t=e.sendMessage,c=e.activeContact,n=Object(a.useState)(""),s=Object(h.a)(n,2),r=s[0],i=s[1],o=Object(a.useRef)(null);return Object(a.useEffect)((function(){!function(){var e;null===(e=o.current)||void 0===e||e.scrollIntoView()}()}),[c]),Object(_.jsxs)("div",{className:"chatbox",children:["object"!==typeof c?Object(_.jsx)("p",{className:"chatbox__placeholder",children:c}):Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)("div",{className:"chatbox__active__contact",children:[Object(_.jsxs)("div",{className:"contact__wrapper__image",children:[c.image,Object(_.jsx)("div",{className:"contact__wrapper__image__icon",children:Object(_.jsx)(d.b,{})})]}),Object(_.jsx)("h4",{children:c.name}),Object(_.jsx)("div",{className:"chatbox__back_arrow",onClick:function(){return window.document.body.scrollIntoView()},children:Object(_.jsx)(d.a,{})})]}),Object(_.jsx)("div",{className:"chatbox__chat",children:c.chatHistory.map((function(e,t){return Object(_.jsxs)("div",{className:"chatbox_message_wrapper",children:[Object(_.jsxs)("div",{className:"You"===e.from?"chatbox__message__outcoming":"chatbox__message__incoming",children:["You"!==e.from?Object(_.jsx)("div",{children:c.image}):null,Object(_.jsx)("p",{className:"You"===e.from?"chatbox__message__outcoming__text":"chatbox__message__incoming__text",children:e.message})]}),Object(_.jsx)("p",{className:"You"===e.from?"chatbox__message__outcoming__date":"chatbox__message__incoming__date",children:new Date(e.date).toLocaleString()})]},t)}))})]}),"string"!==typeof c?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("div",{ref:o}),Object(_.jsxs)("form",{onSubmit:function(e){e.preventDefault(),r&&(t(r),i(""))},children:[Object(_.jsx)("input",{value:r,placeholder:"Type your message",onChange:function(e){var t=e.target.value;i(t)},autoFocus:!0}),Object(_.jsx)("button",{type:"submit",children:Object(_.jsx)(b.a,{})})]})]}):null]})},x=c(13);function f(){var e=Math.floor(16777215*Math.random()).toString(16);return e.length>5?"#".concat(e):f()}var O=function e(t,c,a){Object(x.a)(this,e),this.id=t,this.name=c,this.chatHistory=a,this.image=Object(_.jsx)("div",{style:{width:"50px",height:"50px",borderRadius:"50%",color:"white",textShadow:"-1px 0 black",backgroundColor:f(),textAlign:"center",display:"table-cell",verticalAlign:"middle"},children:this.name[0].toUpperCase()}),this.newMessages=0},p=c(15),g=c(14);var v=function(e){var t=e.selectActiveContact,c=e.contactList,n=e.clearNewMessages,s=Object(a.useState)(""),r=Object(h.a)(s,2),i=r[0],o=r[1];return Object(_.jsxs)("div",{className:"contactsbox",children:[Object(_.jsxs)("div",{className:"contactsbox__header",children:[Object(_.jsxs)("div",{className:"contactsbox__profile",children:[Object(_.jsx)(g.a,{}),Object(_.jsx)("div",{className:"contact__wrapper__image__icon",children:Object(_.jsx)(d.b,{})})]}),Object(_.jsxs)("form",{children:[Object(_.jsx)("div",{className:"contactsbox__svg",children:Object(_.jsx)(p.a,{})}),Object(_.jsx)("input",{type:"search",value:i,placeholder:"Search or start new chat",onChange:function(e){var t=e.target.value;o(t)}})]})]}),Object(_.jsx)("h2",{children:"Chats"}),c.sort((function(e,t){return e.chatHistory.length&&t.chatHistory.length?t.chatHistory[t.chatHistory.length-1].date-e.chatHistory[e.chatHistory.length-1].date:1})).filter((function(e){return i.length?e.name.toLowerCase().includes(i.toLowerCase()):e})).map((function(e){var c=e.chatHistory[e.chatHistory.length-1];return Object(_.jsxs)("div",{onClick:function(){t(e),o(""),n(e.id)},className:"contact__wrapper",children:[Object(_.jsxs)("div",{className:"contact__wrapper__image",children:[e.image,Object(_.jsx)("div",{className:"contact__wrapper__image__icon",children:Object(_.jsx)(d.b,{})})]}),Object(_.jsxs)("div",{className:"contact__wrapper__text",children:[Object(_.jsxs)("h4",{children:["".concat(e.name," "),Object(_.jsx)("span",{className:"contact__wrapper__text__notification",children:e.newMessages>0?e.newMessages:""})]}),Object(_.jsx)("p",{children:c&&"".concat(c.message)})]}),Object(_.jsx)("div",{children:c&&"".concat(new Date(c.date).toLocaleString())})]},e.id)}))]})};var w=function(){var e=Object(a.useState)([]),t=Object(h.a)(e,2),c=t[0],n=t[1],s=Object(a.useState)("Select a chat to start messaging"),r=Object(h.a)(s,2),l=r[0],b=r[1],d=Object(a.useState)(""),x=Object(h.a)(d,2),f=x[0],p=x[1];Object(a.useEffect)((function(){function e(){return(e=Object(u.a)(j.a.mark((function e(){var t,c,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api");case 3:return t=e.sent,e.next=6,t.json();case 6:c=e.sent,a=c.map((function(e){return new O(e._id,e.name,e.chatHistory)})),n(a),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var g=Object(a.useCallback)((function(e){b(e)}),[]);return Object(a.useEffect)((function(){!function(){var e=c.find((function(e){return e.id===l.id}));e&&b(e)}()}),[c,l]),Object(a.useEffect)((function(){f&&l.id!==f&&n((function(e){return e.map((function(e){return e.id===f?Object(o.a)(Object(o.a)({},e),{},{newMessages:e.newMessages+1}):e}))}))}),[f]),Object(a.useEffect)((function(){window.history.scrollRestoration="manual"}),[]),Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(v,{selectActiveContact:g,contactList:c,clearNewMessages:function(e){n((function(t){return t.map((function(t){return t.id===e?Object(o.a)(Object(o.a)({},t),{},{newMessages:0}):t}))}))}}),Object(_.jsx)(m,{sendMessage:function(e){function t(e,t){n((function(c){return c.map((function(c){return c.id===l.id?Object(o.a)(Object(o.a)({},c),{},{chatHistory:[].concat(Object(i.a)(c.chatHistory),[{message:e,date:new Date,from:t}])}):c}))}))}function c(){return(c=Object(u.a)(j.a.mark((function c(){var a,n;return j.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,fetch("/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:l.id,newMessage:{message:e,date:Date.parse(new Date),from:"You",activeContact:l.name}})});case 3:return a=c.sent,c.next=6,a.json();case 6:n=c.sent,setTimeout((function(){t(n,l.name),p(""),p(l.id)}),1e3*Math.round(5*Math.random()+10)),c.next=13;break;case 10:c.prev=10,c.t0=c.catch(0),console.error(c.t0);case 13:case"end":return c.stop()}}),c,null,[[0,10]])})))).apply(this,arguments)}t(e,"You"),function(){c.apply(this,arguments)}()},activeContact:l})]})};r.a.render(Object(_.jsx)(n.a.StrictMode,{children:Object(_.jsx)(w,{})}),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.c13f618b.chunk.js.map